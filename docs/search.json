[{"path":"https://mrc-ide.github.io/spatialbranchr/articles/estimate-joint.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"Jointly estimate effective reproduction number and gravity model parameters","text":"use data West African Ebola epidemic bundled package. illustration, focus countries instead including countries estimation, can take long time run. ` data set 600 rows (row day). estimate model parameters using first 35 days data. object now fitted model. can check ggmcmc check convergence. Note spatialbranchr carry convergence checks. final step, might extract variables friendly format. first component list three-dimensional array dimensions time, space, samples posterior ditribution Rt. can summarise : Since estimated single Rt window location, samples “filled ” day window. can similarly summarise parameters gamma ptsay. can also use obtain flow matrix can used input spatial_project.","code":"data(\"promed_ebola\") data(\"metadata\") incid <- promed_ebola ## Get rid of dates column as we don't need it for fitting incid_raw <- incid[, -1] nloc <- ncol(incid_raw) centroids <- metadata si <- discr_si(k = 0:35, mu = 6, sigma = 4) priors <- spatial_priors() ## countries of interest cntrs <- c(\"SLE\", \"GIN\", \"LBR\", \"GHA\", \"NGA\") x <- incid_raw[1:35, cntrs] pop <- centroids$Pop[centroids$ISO3 %in% cntrs] coords <- centroids[centroids$ISO3 %in% cntrs, c(\"Centroid_Lon\", \"Centroid_Lat\")] ## Generate distance matrix from centroids using geosphere package dist <- distm(coords) ## This can take some time. 120 seconds on my computer with small-ish ## numver of iterations out <- spatial_estimate(   x, si, window = 7L, NULL, pop, dist, 1, 1, 1, \"poisson\", priors, iter = 2000, chains = 2 ) #>  #> SAMPLING FOR MODEL 'estimate_both' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0.001845 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 18.45 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 30.3991 seconds (Warm-up) #> Chain 1:                22.3668 seconds (Sampling) #> Chain 1:                52.7659 seconds (Total) #> Chain 1:  #>  #> SAMPLING FOR MODEL 'estimate_both' NOW (CHAIN 2). #> Chain 2:  #> Chain 2: Gradient evaluation took 0.001585 seconds #> Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 15.85 seconds. #> Chain 2: Adjust your expectations accordingly! #> Chain 2:  #> Chain 2:  #> Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 2:  #> Chain 2:  Elapsed Time: 32.792 seconds (Warm-up) #> Chain 2:                25.3166 seconds (Sampling) #> Chain 2:                58.1086 seconds (Total) #> Chain 2: processed <- process_spatial_estimate(out, x, window = 7L) rt <- processed$Rt rt_summary <- apply(rt, c(1, 2), quantile, probs = c(0.025, 0.5, 0.975))"},{"path":"https://mrc-ide.github.io/spatialbranchr/articles/simulating-data.html","id":"no-movement","dir":"Articles","previous_headings":"","what":"No movement","title":"Simulating outbreaks under a spatially explicit branching process","text":"don’t allow movement three locations, effect simulating three independent outbreaks.","code":"locations <- c(\"A\", \"B\", \"C\") ## Movement matrix, all off-diagonal elemnets are 0. pmat <- matrix(0, nrow = 3, ncol = 3) diag(pmat) <- 1 ## Initial Rt in the three locations r_init <- matrix(rep(2, 3), nrow = 1, ncol = 3) ## Initial incidence, start with a large seed so that the epidemic can ## take off. incid_init <- matrix(rep(20, 3), nrow = 1, ncol = 3)  si <- EpiEstim::discr_si(k = 0:30, mu = 6, sigma = 4)  no_movement <- spatial_project(   incid_init, r_init, si, pmat, n_sim = 1000, n_days = 30,   model = \"poisson\" )  no_movement_df <- as_dataframe(no_movement) tall <- gather(no_movement_df, location, incid, -sim, -day) ggplot(tall) +   geom_line(aes(day, incid, group = sim), alpha = 0.3) +   facet_wrap(~location, nrow = 3)"},{"path":"https://mrc-ide.github.io/spatialbranchr/articles/simulating-data.html","id":"allow-movement","dir":"Articles","previous_headings":"","what":"Allow movement","title":"Simulating outbreaks under a spatially explicit branching process","text":"now modify probability movement allow movement locations.","code":"puni <- matrix(   c(0.8, 0.1, 0.1, 0.2, 0.3, 0.5, 0.3, 0.3, 0.4), nrow = 3, ncol = 3 ) uni_movement <- spatial_project(   incid_init, r_init, si, puni, n_sim = 1000, n_days = 30,   model = \"poisson\" )  uni_movement <- as_dataframe(uni_movement) tall_uni <- gather(uni_movement, location, incid, -sim, -day) ggplot(tall) +   geom_line(aes(day, incid, group = sim), alpha = 0.3) +   facet_wrap(~location, nrow = 3) priors <- spatial_priors() ##out <- spatial_estimate(uni_movement, si, 7, puni, priors = priors)"},{"path":"https://mrc-ide.github.io/spatialbranchr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Pierre Nouvellet. Author. Anne cori. Author. Sangeeta Bhatia. Author, maintainer.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Nouvellet P, cori , Bhatia S (2022). spatialbranchr: Spatially explicit branching process model. R package version 1.0.0.0, https://mrc-ide.github.io/spatialbranchr/.","code":"@Manual{,   title = {spatialbranchr: Spatially explicit branching process model},   author = {Pierre Nouvellet and Anne cori and Sangeeta Bhatia},   year = {2022},   note = {R package version 1.0.0.0},   url = {https://mrc-ide.github.io/spatialbranchr/}, }"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/as_dataframe.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert the projections to a data.frame — as_dataframe","title":"Convert the projections to a data.frame — as_dataframe","text":"function convers output spatial_project function wide data.frame.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/as_dataframe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert the projections to a data.frame — as_dataframe","text":"","code":"as_dataframe(x)"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/as_dataframe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert the projections to a data.frame — as_dataframe","text":"x output spatial_project","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/as_dataframe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert the projections to a data.frame — as_dataframe","text":"data.frame columns sim, day, 1 column location.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/as_dataframe.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Convert the projections to a data.frame — as_dataframe","text":"Sangeeta Bhatia, Anne Cori, Pierre Nouvellet","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/force_of_infection.html","id":null,"dir":"Reference","previous_headings":"","what":"Force of infection under a spatially explicit brancing process model — force_of_infection","title":"Force of infection under a spatially explicit brancing process model — force_of_infection","text":"function computes force infection time t + 1 locations 1, 2,....n given incidence (onset) locations, serial interval probabilities movement individuals infectious period.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/force_of_infection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Force of infection under a spatially explicit brancing process model — force_of_infection","text":"","code":"force_of_infection(x, r_t, ws, pmovement)"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/force_of_infection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Force of infection under a spatially explicit brancing process model — force_of_infection","text":"x matrix past incidence (integer). matrix 1 column location; , column interpreted incidence location. r_t matrix reproduction numbers times 1 t locations 1 n. ws flipped serial interval pmovement n_locations X n_locations matrix probability movement locations. Entry row , column j probability case move j infectious period.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/force_of_infection.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Force of infection under a spatially explicit brancing process model — force_of_infection","text":"Sangeeta Bhatia, Anne Cori, Pierre Nouvellet","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/make_rindex.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare index matrix for Rt — make_rindex","title":"Prepare index matrix for Rt — make_rindex","text":"Prepare index matrix Rt","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/make_rindex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare index matrix for Rt — make_rindex","text":"","code":"make_rindex(window, nloc, T)"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/make_rindex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare index matrix for Rt — make_rindex","text":"window integer indicating length window Rt estimated. Window length assumed locations. Default value 7 .e. Rt estimated weekly window. Currently non-overlapping windows supported. nloc integer. Number locations. T integer. Number time steps","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/make_rindex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare index matrix for Rt — make_rindex","text":"matrix R index","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/make_rindex.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare index matrix for Rt — make_rindex","text":"utility function prepares index matrix Rt estimation Stan. Say two locations time series cases 14 days. location, want estimate Rt 7 day window , model 4 parameters Rt (two location). matrix looks like: columns index locations rows index time points.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/make_rindex.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Prepare index matrix for Rt — make_rindex","text":"Sangeeta Bhatia, Anne Cori, Pierre Nouvellet","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/make_rindex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare index matrix for Rt — make_rindex","text":"","code":"make_rindex(7, 2, 14) #>       [,1] [,2] #>  [1,]    1    2 #>  [2,]    1    2 #>  [3,]    1    2 #>  [4,]    1    2 #>  [5,]    1    2 #>  [6,]    1    2 #>  [7,]    1    2 #>  [8,]    3    4 #>  [9,]    3    4 #> [10,]    3    4 #> [11,]    3    4 #> [12,]    3    4 #> [13,]    3    4 #> [14,]    3    4 make_rindex(4, 2, 14) #> Warning: data length [32] is not a sub-multiple or multiple of the number of rows [14] #>       [,1] [,2] #>  [1,]    1    2 #>  [2,]    1    2 #>  [3,]    1    2 #>  [4,]    1    2 #>  [5,]    3    4 #>  [6,]    3    4 #>  [7,]    3    4 #>  [8,]    3    4 #>  [9,]    5    6 #> [10,]    5    6 #> [11,]    5    6 #> [12,]    5    6 #> [13,]    7    8 #> [14,]    7    8"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Centroids and populations of all countries — metadata","title":"Centroids and populations of all countries — metadata","text":"data set gives latitudes longitudes centroids countries African mainland. Also included population sizes. data needed jointly estimate reproduction numbers parameters movement model spatially explicit brancing process model implemented package.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/metadata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Centroids and populations of all countries — metadata","text":"dataframe consisting 55 rows 23 columns. columns interest Centroid_Lon, Centroid_Lat, Pop","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/metadata.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Centroids and populations of all countries — metadata","text":"LandScan 2015 dataset grid","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/metadata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Centroids and populations of all countries — metadata","text":"Bhatia, S., Lassmann, B., Cohn, E. et al. Using digital surveillance tools near real-time mapping risk infectious disease spread. npj Digit. Med. 4, 73 (2021). https://doi.org/10.1038/s41746-021-00442-3","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/process_spatial_estimate.html","id":null,"dir":"Reference","previous_headings":"","what":"Process the spatially explicit branching process model fitted to incidence — process_spatial_estimate","title":"Process the spatially explicit branching process model fitted to incidence — process_spatial_estimate","text":"function processes fitted object returned `spatial_estimate`. processing consists translating vector effective reproduction number parameters space-time matrix easier interpret.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/process_spatial_estimate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process the spatially explicit branching process model fitted to incidence — process_spatial_estimate","text":"","code":"process_spatial_estimate(fit, x, window, samples = 1000L)"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/process_spatial_estimate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process the spatially explicit branching process model fitted to incidence — process_spatial_estimate","text":"fit stanfit object returned `spatial_estimate` x matrix past incidence (integer). matrix 1 column location; , column interpreted incidence location. window integer indicating length window Rt estimated. Window length assumed locations. Default value 7 .e. Rt estimated weekly window. Currently non-overlapping windows supported.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/process_spatial_estimate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process the spatially explicit branching process model fitted to incidence — process_spatial_estimate","text":"list 3 elements: (1) three-dimensional matrix first dimension time, second dimension number spatial units, thirs dimesnion desired number samples posterior distributions Rt; (2)","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/process_spatial_estimate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Process the spatially explicit branching process model fitted to incidence — process_spatial_estimate","text":"Sangeeta Bhatia","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/promed_ebola.html","id":null,"dir":"Reference","previous_headings":"","what":"Processed data on the 2013–2016 West African Ebola epidemic — promed_ebola","title":"Processed data on the 2013–2016 West African Ebola epidemic — promed_ebola","text":"data set gives daily incidence Ebola cases (includes suspected confirmed cases) country Africa. Note countries experience Ebola cases epidemic. '0s' filled convenience. raw data colleced ProMED pre-processing pipeline described detail elsewhere (See linked paper).","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/promed_ebola.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Processed data on the 2013–2016 West African Ebola epidemic — promed_ebola","text":"dataframe consisting 656 rows 56 columns. first column consists dates remaining 55 columns contain incidence Ebola cases country African mainland. Column names ISO3 country codes countries.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/promed_ebola.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Processed data on the 2013–2016 West African Ebola epidemic — promed_ebola","text":"Bhatia, S., Lassmann, B., Cohn, E. et al. Using digital surveillance tools near real-time mapping risk infectious disease spread. npj Digit. Med. 4, 73 (2021). https://doi.org/10.1038/s41746-021-00442-3","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/promed_ebola.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Processed data on the 2013–2016 West African Ebola epidemic — promed_ebola","text":"Bhatia, S., Lassmann, B., Cohn, E. et al. Using digital surveillance tools near real-time mapping risk infectious disease spread. npj Digit. Med. 4, 73 (2021). https://doi.org/10.1038/s41746-021-00442-3","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/sd2.html","id":null,"dir":"Reference","previous_headings":"","what":"Standard deviation with optional args — sd2","title":"Standard deviation with optional args — sd2","text":"function computes standard deviation values x. calls stats::sd except also accepts optional arguments therefore can used conjunction functions summarise_projections.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/sd2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Standard deviation with optional args — sd2","text":"","code":"sd2(vec, ...)"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/sd2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Standard deviation with optional args — sd2","text":"vec numeric vector ... optional arguments","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/sd2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Standard deviation with optional args — sd2","text":"numeric. standard deviation","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/sd2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Standard deviation with optional args — sd2","text":"Sangeeta Bhatia, Anne Cori, Pierre Nouvellet","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_estimate.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate effective reproduction number using a spatially explicit\nbranching process model. — spatial_estimate","title":"Estimate effective reproduction number using a spatially explicit\nbranching process model. — spatial_estimate","text":"Given past incidence N locations, function () jointly estimates reproduction number probability movement, (b) pmovement NULL, estimates reproduction number","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_estimate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate effective reproduction number using a spatially explicit\nbranching process model. — spatial_estimate","text":"","code":"spatial_estimate(   x,   si,   window = 7L,   pmovement = NULL,   population,   distance,   alpha,   beta,   K,   model = \"poisson\",   priors,   ... )"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_estimate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate effective reproduction number using a spatially explicit\nbranching process model. — spatial_estimate","text":"x matrix past incidence (integer). matrix 1 column location; , column interpreted incidence location. si matrix discretised serial interval, assumed locations. can generated easily using package EpiEstim. See vignettes examples. window integer indicating length window Rt estimated. Window length assumed locations. Default value 7 .e. Rt estimated weekly window. Currently non-overlapping windows supported. pmovement either NULL N X N matrix N number locations. pmovement NULL, function jointly estimates parameters gravity branching process models. gravity model describes population movement brancing process model describes underlying transmission process. population vector length N giving populations location. Silently ignored pmovement NULL distance N X N matrix distances N locations. Silently ignored pmovement NULL alpha gravity model paramater; exponent source population beta gravity model paramater; exponent destination population K gravity model paramater model Currently \"poisson\" supported priors list specifying priors model. use default priors, use function `spatial_priors` ... Additional parameters passed stan","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_estimate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate effective reproduction number using a spatially explicit\nbranching process model. — spatial_estimate","text":"Fitted stan model,  stanfit object","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_estimate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Estimate effective reproduction number using a spatially explicit\nbranching process model. — spatial_estimate","text":"Sangeeta Bhatia","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_priors.html","id":null,"dir":"Reference","previous_headings":"","what":"Default priors for parameters of a spatially explicit branching process\nmodel — spatial_priors","title":"Default priors for parameters of a spatially explicit branching process\nmodel — spatial_priors","text":"parameters effective reproduction number exponent distance gravity model, jointly estimated. Effective reproduction number assumed Gamma distributed therefore, mean standard deviation need specified. automataically translated shape scale paramaters. estimating effective reproduction number, `gamma` component list silently ignored.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_priors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default priors for parameters of a spatially explicit branching process\nmodel — spatial_priors","text":"","code":"spatial_priors()"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_priors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default priors for parameters of a spatially explicit branching process\nmodel — spatial_priors","text":"list default parameters priors. Values can manually edited examples .","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_priors.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Default priors for parameters of a spatially explicit branching process\nmodel — spatial_priors","text":"Sangeeta Bhatia","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_priors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Default priors for parameters of a spatially explicit branching process\nmodel — spatial_priors","text":"","code":"priors <- spatial_priors() priors$gamma <- 2"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_project.html","id":null,"dir":"Reference","previous_headings":"","what":"Project future incidence — spatial_project","title":"Project future incidence — spatial_project","text":"Simulate future incidence based past incidence multiple locations, matrix (possibly time-varying) reproduction numbers location, matrix serial intervals, matrix relative movement locations.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_project.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Project future incidence — spatial_project","text":"","code":"spatial_project(x, R, si, pmovement, n_sim, n_days, model = \"poisson\")"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_project.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Project future incidence — spatial_project","text":"x matrix past incidence (integer). matrix 1 column location; , column interpreted incidence location. R n_days X n_locations matrix reproduction numbers; n_days either 1 number days want project, n_locations number locations (.e. number columns x). R 1 row, values recycled. si matrix discretised serial interval, assumed locations. can generated easily using package EpiEstim. See vignettes examples. pmovement n_locations X n_locations matrix probability movement locations. Entry row , column j probability case move j infectious period. n_sim number epicurves simulate. Defaults 100. n_days projection horizon. Defaults 7. model Currently \"poisson\" supported","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_project.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Project future incidence — spatial_project","text":"array conatining projected incidence. dimensions returned array n_days X n_locations X n_sim","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatial_project.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Project future incidence — spatial_project","text":"Sangeeta Bhatia, Anne Cori, Pierre Nouvellet","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatialbranchr-package.html","id":null,"dir":"Reference","previous_headings":"","what":"The 'spatialbranchr' package. — spatialbranchr-package","title":"The 'spatialbranchr' package. — spatialbranchr-package","text":"spatialbranchr implements spatially explicit branching process model","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/spatialbranchr-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The 'spatialbranchr' package. — spatialbranchr-package","text":"Stan Development Team (2022). RStan: R interface Stan. R package version 2.21.5. https://mc-stan.org","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/summarise_projections.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise projections across simulations — summarise_projections","title":"Summarise projections across simulations — summarise_projections","text":"Extract summary statistics projections","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/summarise_projections.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise projections across simulations — summarise_projections","text":"","code":"summarise_projections(   x,   funs = c(quantile = quantile, min = min, max = max, mean = mean, sd = sd2),   ... )"},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/summarise_projections.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise projections across simulations — summarise_projections","text":"x output spatial_project function funs list summary functions applied. user's responsibility ensure functions valid can applied vector. Defaults quantile, min, max, mean sd. ... Additional arguments funs, e.g. na.rm, probs","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/summarise_projections.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise projections across simulations — summarise_projections","text":"list length supplied functions. element list result applying corresponding function across simulations day location.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/summarise_projections.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarise projections across simulations — summarise_projections","text":"want use multiple functions  pass optional arguments na.rm, use sd2 rather sd estimate standard deviation. sd accept optional arguments.","code":""},{"path":"https://mrc-ide.github.io/spatialbranchr/reference/summarise_projections.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summarise projections across simulations — summarise_projections","text":"Sangeeta Bhatia, Anne Cori, Pierre Nouvellet","code":""}]
